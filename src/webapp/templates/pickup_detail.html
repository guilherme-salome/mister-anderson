{% extends "base.html" %}

{% block title %}Pickup {{ pickup_number }}{% endblock %}

{% block page_heading %}
  <div class="top-bar__content">
    <button class="icon-button icon-button--ghost" onclick="window.history.back()" aria-label="Go back">←</button>
    <div>
      <h1 class="top-bar__title">Pickup {{ pickup_number }}</h1>
      <p class="top-bar__subtitle">{{ pallets|length }} pallet{{ '' if pallets|length == 1 else 's' }} tracked</p>
    </div>
  </div>
{% endblock %}

{% block content %}
  <section class="card card--inset">
    <h2 class="section-title">Pallet overview</h2>
    <p class="section-lede">
      Select a pallet to open its product capture workspace. Pallets are created in the external workflow and sync automatically.
    </p>
  </section>

  <section class="card-list">
    {% for pallet in pallets %}
      <article class="data-card">
        <header class="data-card__header">
          <h2 class="data-card__title">
            Pallet <span>{{ pallet.COD_ASSETS or 'Unassigned' }}</span>
          </h2>
          <span class="data-card__meta">
            Updated {{ pallet.DT_UPDATE or "—" }}
          </span>
        </header>
        <dl class="data-card__details">
          <div>
            <dt>Total entries</dt>
            <dd>{{ pallet.TOTAL_ENTRIES or 0 }}</dd>
          </div>
        </dl>
        <footer class="data-card__footer">
          <a class="button button--secondary button--block"
             href="/pickups/{{ pickup_number }}/pallets/{{ pallet.COD_ASSETS | urlencode }}">
            Open pallet
          </a>
        </footer>
      </article>
    {% else %}
      <p class="empty-state">
        No pallets found. Pallets must be created in the external workflow before products can be captured.
      </p>
    {% endfor %}
  </section>
{% endblock %}

{% block floating_action %}
  {% if can_edit %}
    <button class="fab fab--info" type="button" onclick="alert('Create pallets via the external workflow.')" aria-label="Pallet guidance">
      ℹ️
    </button>
  {% endif %}
{% endblock %}

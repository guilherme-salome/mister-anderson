{% extends "base.html" %}

{% block title %}Pickup {{ pickup_number }}{% endblock %}

{% block page_heading %}
  <div class="top-bar__content">
    <button class="icon-button icon-button--ghost" onclick="window.history.back()" aria-label="Go back">←</button>
    <div>
      <h1 class="top-bar__title">Pickup {{ pickup_number }}</h1>
      <p class="top-bar__subtitle">
        {% if client_id %}
          Client {{ client_id }}
          {% if user.role == 'admin' and client_name %}
            ({{ client_name }})
          {% endif %}
          ·
        {% endif %}
        {{ pallets|length }} pallet{{ '' if pallets|length == 1 else 's' }} tracked
      </p>
    </div>
  </div>
{% endblock %}

{% block content %}

  <section class="card-list">
    {% for pallet in pallets %}
      <article class="data-card">
        <header class="data-card__header">
          <h2 class="data-card__title">
            {% set employee_pallet = pallet.PALLET_NUMBER if pallet.PALLET_NUMBER is not none else None %}
            Pallet <span>{{ employee_pallet if employee_pallet is not none else '—' }}</span>
          </h2>
          <span class="data-card__meta">
            Updated {{ pallet.DT_UPDATE_DATE or "—" }}
          </span>
        </header>
        <dl class="data-card__details">
          <div>
            <dt>Weight</dt>
            <dd>
              {% if pallet.WEIGHT is not none %}
                {{ '%.0f' % pallet.WEIGHT }}
              {% else %}
                —
              {% endif %}
            </dd>
          </div>
          <div>
            <dt>COD_ASSETS</dt>
            <dd>{{ pallet.COD_ASSETS or 'Unassigned' }}</dd>
          </div>
          <div>
            <dt>Total entries</dt>
            <dd>{{ pallet.TOTAL_ENTRIES or 0 }}</dd>
          </div>
        </dl>
        <footer class="data-card__footer">
          <a class="button button--secondary button--block"
             href="/pickups/{{ pickup_number }}/pallets/{{ pallet.COD_ASSETS | urlencode }}">
            Open pallet
          </a>
        </footer>
      </article>
    {% else %}
      <p class="empty-state">
        No pallets found.
      </p>
    {% endfor %}
  </section>
{% endblock %}

{% block floating_action %}{% endblock %}
